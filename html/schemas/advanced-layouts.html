<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Advanced Layouts for IPLD Schemas | IPLD Specifications</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Specifications for the Inter-planetary Linked Data project">
    
    <link rel="preload" href="/assets/css/0.styles.1c4fef16.css" as="style"><link rel="preload" href="/assets/js/app.398f8b12.js" as="script"><link rel="preload" href="/assets/js/2.47786eef.js" as="script"><link rel="preload" href="/assets/js/79.8f505fec.js" as="script"><link rel="prefetch" href="/assets/js/10.fc6aff28.js"><link rel="prefetch" href="/assets/js/100.6ea9f1c4.js"><link rel="prefetch" href="/assets/js/101.8a3976e5.js"><link rel="prefetch" href="/assets/js/102.e13df111.js"><link rel="prefetch" href="/assets/js/103.b0f7d528.js"><link rel="prefetch" href="/assets/js/11.237acee7.js"><link rel="prefetch" href="/assets/js/12.7b311b3e.js"><link rel="prefetch" href="/assets/js/13.a9c55d15.js"><link rel="prefetch" href="/assets/js/14.d7da8be6.js"><link rel="prefetch" href="/assets/js/15.9c985ac3.js"><link rel="prefetch" href="/assets/js/16.3bc612d6.js"><link rel="prefetch" href="/assets/js/17.eb822ab7.js"><link rel="prefetch" href="/assets/js/18.9bece705.js"><link rel="prefetch" href="/assets/js/19.f342a28d.js"><link rel="prefetch" href="/assets/js/20.1ea1c788.js"><link rel="prefetch" href="/assets/js/21.9483d0be.js"><link rel="prefetch" href="/assets/js/22.28df1156.js"><link rel="prefetch" href="/assets/js/23.e106896f.js"><link rel="prefetch" href="/assets/js/24.136d8b68.js"><link rel="prefetch" href="/assets/js/25.4652b127.js"><link rel="prefetch" href="/assets/js/26.abdb7c5a.js"><link rel="prefetch" href="/assets/js/27.81f3a367.js"><link rel="prefetch" href="/assets/js/28.45622476.js"><link rel="prefetch" href="/assets/js/29.226cb870.js"><link rel="prefetch" href="/assets/js/3.97cbb82f.js"><link rel="prefetch" href="/assets/js/30.3ad9b46b.js"><link rel="prefetch" href="/assets/js/31.080b29ba.js"><link rel="prefetch" href="/assets/js/32.ac85b868.js"><link rel="prefetch" href="/assets/js/33.37d682bf.js"><link rel="prefetch" href="/assets/js/34.0313a448.js"><link rel="prefetch" href="/assets/js/35.b70107b9.js"><link rel="prefetch" href="/assets/js/36.f083e171.js"><link rel="prefetch" href="/assets/js/37.3f6e7002.js"><link rel="prefetch" href="/assets/js/38.9c81347c.js"><link rel="prefetch" href="/assets/js/39.04e4f4bd.js"><link rel="prefetch" href="/assets/js/4.154d6850.js"><link rel="prefetch" href="/assets/js/40.56fa69df.js"><link rel="prefetch" href="/assets/js/41.d6054697.js"><link rel="prefetch" href="/assets/js/42.ddcb2fb3.js"><link rel="prefetch" href="/assets/js/43.a4fa6d45.js"><link rel="prefetch" href="/assets/js/44.c33b7e26.js"><link rel="prefetch" href="/assets/js/45.2dd58966.js"><link rel="prefetch" href="/assets/js/46.ca835d79.js"><link rel="prefetch" href="/assets/js/47.575b064e.js"><link rel="prefetch" href="/assets/js/48.fd7338ca.js"><link rel="prefetch" href="/assets/js/49.dae162f5.js"><link rel="prefetch" href="/assets/js/5.05324856.js"><link rel="prefetch" href="/assets/js/50.80c89777.js"><link rel="prefetch" href="/assets/js/51.fdc143c4.js"><link rel="prefetch" href="/assets/js/52.2d2e8810.js"><link rel="prefetch" href="/assets/js/53.7ec404bd.js"><link rel="prefetch" href="/assets/js/54.73b115f3.js"><link rel="prefetch" href="/assets/js/55.6850da89.js"><link rel="prefetch" href="/assets/js/56.74142523.js"><link rel="prefetch" href="/assets/js/57.f0a1ff10.js"><link rel="prefetch" href="/assets/js/58.e26a767b.js"><link rel="prefetch" href="/assets/js/59.66403a90.js"><link rel="prefetch" href="/assets/js/6.6e2dfd78.js"><link rel="prefetch" href="/assets/js/60.2741bf4a.js"><link rel="prefetch" href="/assets/js/61.c9ca4d9a.js"><link rel="prefetch" href="/assets/js/62.b054847f.js"><link rel="prefetch" href="/assets/js/63.6c80aa00.js"><link rel="prefetch" href="/assets/js/64.e78c4a3c.js"><link rel="prefetch" href="/assets/js/65.6cad650a.js"><link rel="prefetch" href="/assets/js/66.e024d09a.js"><link rel="prefetch" href="/assets/js/67.9bd38c4d.js"><link rel="prefetch" href="/assets/js/68.3cd1c085.js"><link rel="prefetch" href="/assets/js/69.163e6a1c.js"><link rel="prefetch" href="/assets/js/7.e86b86be.js"><link rel="prefetch" href="/assets/js/70.3cd614d6.js"><link rel="prefetch" href="/assets/js/71.1d12e379.js"><link rel="prefetch" href="/assets/js/72.521e4e34.js"><link rel="prefetch" href="/assets/js/73.64a2f981.js"><link rel="prefetch" href="/assets/js/74.6a3b5afa.js"><link rel="prefetch" href="/assets/js/75.f90776b8.js"><link rel="prefetch" href="/assets/js/76.bb92253c.js"><link rel="prefetch" href="/assets/js/77.b276ca6e.js"><link rel="prefetch" href="/assets/js/78.d3de5c03.js"><link rel="prefetch" href="/assets/js/8.b12cf945.js"><link rel="prefetch" href="/assets/js/80.60d82f9e.js"><link rel="prefetch" href="/assets/js/81.b9b7539f.js"><link rel="prefetch" href="/assets/js/82.2dc1b099.js"><link rel="prefetch" href="/assets/js/83.a89da852.js"><link rel="prefetch" href="/assets/js/84.9b9c8a03.js"><link rel="prefetch" href="/assets/js/85.a340ac2f.js"><link rel="prefetch" href="/assets/js/86.34d52046.js"><link rel="prefetch" href="/assets/js/87.3ee6f7ee.js"><link rel="prefetch" href="/assets/js/88.d184aae2.js"><link rel="prefetch" href="/assets/js/89.4a2a44c2.js"><link rel="prefetch" href="/assets/js/9.497fa810.js"><link rel="prefetch" href="/assets/js/90.f5d33a75.js"><link rel="prefetch" href="/assets/js/91.0c08a7a6.js"><link rel="prefetch" href="/assets/js/92.8279b4c4.js"><link rel="prefetch" href="/assets/js/93.da2c14ed.js"><link rel="prefetch" href="/assets/js/94.596d7cbf.js"><link rel="prefetch" href="/assets/js/95.94d00784.js"><link rel="prefetch" href="/assets/js/96.3c524265.js"><link rel="prefetch" href="/assets/js/97.084146b1.js"><link rel="prefetch" href="/assets/js/98.8cd5de75.js"><link rel="prefetch" href="/assets/js/99.33255290.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1c4fef16.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">IPLD Specifications</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/schemas/" class="nav-link">
  IPLD Schemas
</a></div> <a href="https://github.com/ipld/specs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/schemas/" class="nav-link">
  IPLD Schemas
</a></div> <a href="https://github.com/ipld/specs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Advanced Layouts for IPLD Schemas</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/html/schemas/advanced-layouts.html#basic-schema-definition-and-use" class="sidebar-link">Basic Schema Definition and Use</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="advanced-layouts-for-ipld-schemas"><a href="#advanced-layouts-for-ipld-schemas" class="header-anchor">#</a> Advanced Layouts for IPLD Schemas</h1> <p>An &quot;advanced layout&quot; is a special type in an IPLD Schema that denotes an abstract node that may <em>act</em> as one of the standard IPLD <a href="/html/schemas/schema-kinds.html">schema kinds</a> when interacted with above the schema layer, but be represented in entirely different data forms at the data model layer. Advanced layouts allow us to use transformational logic to present consistent interfaces to significantly more complex data than the data model otherwise allows or significantly larger data than reasonable block sizes allow.</p> <p>Data structures such as maps, lists or byte arrays may be implemented in novel forms with the data model and may even transparently cross block boundaries to present data that is potentially both larger and more complex than a standard data model kind while affording the standard data model API interaction modes of their respective kinds.</p> <p>Example uses of advanced layouts include:</p> <ul><li>Very large byte arrays that may cross many block boundaries but still present a standard <code>bytes</code> kind interface.</li> <li>Maps that can be sharded across many blocks allowing efficient access via standard <code>map</code> kind interfaces while allowing extremely large storage.</li> <li>Encrypted block mechanisms that are able to encode and decode data at the data model layer (perhaps in <code>byte</code> or <code>string</code> form) while presenting as unencrypted kinds when accessed through the schema layer.</li> <li>Novel kind representation formats, such as high-precision or large numbers or alternative string encoding formats. Although size constraints at the language layer for number kinds may represent challenges for large or high-precision number formats.</li></ul> <p>Advanced layouts necessarily involve a form of logic to perform their data transformations. Many use-cases even necessitate interaction with block loading and storing mechanisms, such as traversal of a large <code>bytes</code> array stored across a chain of blocks. There is currently no formal requirement for where this logic resides, how it is loaded, or how it is associated with an IPLD Schema definition. This topic will continue to evolve. There is potential in the future for such logic to be embedded <em>in</em> IPLD blocks themselves via WebAssembly, such that an advanced layout is represented both by the data and the logic required to read it. See <a href="https://github.com/ipld/specs/issues/130" target="_blank" rel="noopener noreferrer">#130<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for an early exploration of some of these themes.</p> <h2 id="basic-schema-definition-and-use"><a href="#basic-schema-definition-and-use" class="header-anchor">#</a> Basic Schema Definition and Use</h2> <p>At its most basic, no properties are mandated for advanced layout. One may be defined simply with the keyword <code>advanced</code> in a similar manner to <code>type</code>:</p> <div class="language-ipldsch extra-class"><pre class="language-ipldsch"><code><span class="token typedef"><span class="token keyword">advanced</span> <span class="token class-name">ROT13</span></span>
</code></pre></div><p>It may then be used as an <code>advanced</code> <code>representation</code> for a <code>type</code>, from which we can infer the <code>kind</code> that we expect.</p> <div class="language-ipldsch extra-class"><pre class="language-ipldsch"><code><span class="token typedef"><span class="token keyword">type</span> <span class="token class-name">MyString</span></span> <span class="token keyword">string</span> representation advanced ROT13
</code></pre></div><p>Similarly, an advanced layout implementing a sharded <code>map</code> may be defined and used as:</p> <div class="language-ipldsch extra-class"><pre class="language-ipldsch"><code><span class="token typedef"><span class="token keyword">advanced</span> <span class="token class-name">ShardedMap</span></span>

<span class="token typedef"><span class="token keyword">type</span> <span class="token class-name">MyMap</span></span> <span class="token punctuation">{</span> String <span class="token punctuation">:</span> <span class="token punctuation">&amp;</span>Any <span class="token punctuation">}</span> representation advanced ShardedMap
</code></pre></div><p>From this usage, we may infer that <code>ShardedMap</code> can (1) present a familiar <code>map</code> kind interface and (2) store <code>link</code>s as values (with no specific &quot;expectedType&quot;), referenced by standard data model <code>string</code>s. Other operating modes for <code>ShardedMap</code> may also be possible (it may be able to store other value kinds, or it may even be able to act as a <code>bytes</code> kind in spite of its name!).</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ipld/specs/edit/master/html/schemas/advanced-layouts.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.398f8b12.js" defer></script><script src="/assets/js/2.47786eef.js" defer></script><script src="/assets/js/79.8f505fec.js" defer></script>
  </body>
</html>
